---
title: "DPH data analysis"
author: "Lyubava Erko"
date: "10/11/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r, message = FALSE, echo = FALSE, warning = FALSE}
library(mgcv)
library(goft)
library(car)
library(performance)
library(DHARMa)
library(fitdistrplus)
library(gamlss)
library(tidyverse)
library(here)
```
# 0-25 percentile

```{r}
DPH_acute = read_csv(here("./Data/DS copepod data - DPH acute_right one.csv")) %>%
    mutate(percentile = as.factor(percentile), time_min = as.factor(time_min))
```


```{r}
DPH_acute_0_25 <- DPH_acute %>%
  filter(percentile == "0-25") %>%
  group_by(treatment)
```


```{r}
ggplot(DPH_acute_0_25, aes(x = time_min,
                           y = copepod_count,
                           colour = treatment,
                           fill=treatment)) +
  geom_point() +
  theme_classic()+
  geom_smooth(method="lm")
```

# 25-50 percentile

```{r}
DPH_acute_25_50 <- DPH_acute %>%
  filter(percentile == "25-50") %>%
  group_by(treatment)
```


```{r}
ggplot(DPH_acute_25_50, aes(x = time_min,
                           y = copepod_count,
                           colour = treatment,
                           fill=treatment)) +
  geom_point() +
  theme_classic()+
  geom_smooth(method="lm")
```

## Percentile 50-75

```{r}
DPH_acute_50_75 <- DPH_acute %>%
  filter(percentile == "50-75") %>%
  group_by(treatment)
```


```{r}
ggplot(DPH_acute_50_75, aes(x = time_min,
                           y = copepod_count,
                           colour = treatment,
                           fill=treatment)) +
  geom_point() +
  theme_classic()+
  geom_smooth(method="lm")
```

## Percentile 75-100

```{r}
DPH_acute_75_100 <- DPH_acute %>%
  filter(percentile == "75-100") %>%
  group_by(treatment)
```


```{r}
ggplot(DPH_acute_75_100, aes(x = time_min,
                           y = copepod_count,
                           colour = treatment,
                           fill=treatment)) +
  geom_point() +
  theme_classic()+
  geom_smooth(method="lm")
```

#look at shapiro test for normality because we have count data/ proportion data (gamma distribution), which is often non-normal. See ppt slides on topic 6. 
Use beta distribution for proportion data. Gamma might also work.Use desk disc fnbction and do hist discs + fit disc function most importantly.
Do mutate function to have a proportion from 0 to 1.
Turn percentile column into a factor.

___
Try binomial distribution for percentiles 1 and 2, and 3 and 4. Include the biological effect. 

__
sgswuitchik
uwitchink
